# HO-Kit 桌面客户端（新版本测试中）

> 一站式 Harmony Next 应用开发辅助工具：设备投屏、性能监控、应用解析、应用重签名

---

## 一、项目简介

HO-Kit 是一款面向 Harmony Next 应用开发者的桌面工具，将投屏、性能监控、UI 结构分析、应用重签名等高频开发场景整合到统一界面中，帮助开发者提升调试效率、减少工具切换成本。

**主要解决的问题**：
- 需要实时查看设备画面，但官方工具功能有限
- 想快速分析应用性能瓶颈（FPS、CPU、内存等）
- 需要查看界面控件结构，定位 UI 问题
- 频繁进行调试签名，流程繁琐

---

## 二、下载与安装

### 2.1 下载安装包（推荐）

前往本仓库的 [Releases](https://github.com/yabi-zzh/HarmonyScrcpy/releases) 页面，下载适合你操作系统的安装包：

| 操作系统 | 安装包格式 | 说明 |
|---------|-----------|------|
| Windows | `.exe` | 双击运行安装程序，按提示完成安装 |
| macOS   | `.dmg` | 打开后将应用拖入 Applications 文件夹 |
| Linux   | `.AppImage` | 通用格式，无需安装直接运行 |

### 2.2 设备与环境要求

使用 HO-Kit 的大部分功能需要连接 Harmony Next 设备，请确保：

- **HDC 工具**：HO-Kit 已内置 HDC（Harmony Device Connector），无需额外配置
  - 如果系统 PATH 中已配置 HDC，优先使用系统版本
  - 如果系统未配置，自动使用内置版本
- **设备连接**：
  - **USB 连接**：使用数据线将 Harmony Next 设备连接到电脑，并在设备上开启「开发者选项」和「USB 调试」
  - **网络连接**：确保设备和电脑在同一局域网内，并已通过 `hdc tconn <IP>:<端口>` 建立连接
- **Java 环境**（仅重签名功能需要）：
  - **Windows**：已内置 JRE，无需额外配置
  - **macOS / Linux**：需自行安装 JDK 11 或更高版本，并确保 `java` 命令在 PATH 中可用
  - 如果系统已配置 Java 且版本 >= 11，优先使用系统版本

### 2.3 账号要求（部分功能）

以下功能需要登录华为开发者账号：

- **设备注册**：将设备 UDID 注册到开发者账号
- **证书管理**：查看和管理调试/发布证书
- **应用重签名**：使用账号下的证书对应用包进行重签名

> 如果你只使用「投屏」和「性能监控」功能，无需登录账号。

---

## 三、功能介绍与使用说明

### 3.1 设备投屏（内置 UIViewer）

将 Harmony Next 设备的屏幕实时投射到电脑上，并支持远程操作和 UI 结构分析。

**功能特性**：
- 支持 JPEG 与 H.264 两种投屏模式，可根据网络和性能情况灵活选择
- 投屏窗口支持：缩放、双击适配画面、屏幕旋转、窗口置顶、屏幕常亮
- 支持远程按键操作：返回键、Home 键、多任务键、电源键
- 内置 UIViewer：获取当前界面的 UI 树结构，在画面上 Hover / 点击联动高亮控件

**使用步骤**：
1. 在左侧导航栏点击「设备投屏」，进入设备列表页面
2. 确认目标设备已显示在列表中（状态为「在线」）
3. 点击设备卡片上的「开始投屏」按钮
4. 在弹出的投屏窗口中：
   - 查看设备实时画面
   - 使用底部导航栏的按钮进行返回、Home、多任务等操作
   - 右键菜单可设置窗口置顶、屏幕常亮、旋转屏幕等
   - 右键菜单点击「UIViewer」打开 UI 结构面板，获取并分析当前界面控件

**注意事项**：
- H.264 模式画质更高、延迟更低，但需要设备支持；JPEG 模式兼容性更好
- 首次使用投屏时，HO-Kit 会自动向设备推送必要的 Agent 程序
- 如果投屏黑屏或卡顿，可尝试切换投屏模式或检查 USB/网络连接

---

### 3.2 性能监控

实时采集设备和应用的性能指标，帮助分析性能瓶颈。

**功能特性**：
- 采集指标：FPS、CPU 使用率（进程/系统）、GPU 负载、内存（PSS/Heap）、网络流量
- 以时间轴图表形式展示趋势，便于观察性能抖动
- 支持选择目标应用包，针对特定应用进行监控

**使用步骤**：
1. 在左侧导航栏点击「性能监控」
2. 在页面顶部选择目标设备
3. 点击「选择应用」，从设备已安装的应用列表中选择要监控的应用
4. 点击「开始监控」按钮，图表区域将实时显示各项指标
5. 点击「停止监控」结束采集

**注意事项**：
- 性能采集会占用一定的设备资源，建议在非关键测试时使用
- 部分指标（如 GPU 负载）需要设备系统支持，不同设备可能有差异
- 图表数据仅保留最近一段时间的记录，停止监控后可查看历史趋势

---

### 3.3 应用解析

快速解析 HAP / APP / HSP 应用包，查看包内详细信息。

**功能特性**：
- 支持拖拽或点击选择应用包文件
- 解析并展示：包名、版本号、应用名称、图标、权限列表等
- 支持查看包内文件结构
- 方便在安装或重签前确认包信息

**使用步骤**：
1. 在左侧导航栏点击「应用解析」
2. 将 HAP/APP/HSP 文件拖入上传区域，或点击选择文件
3. 等待解析完成，查看包的详细信息
4. 可展开查看权限列表、文件结构等

**注意事项**：
- 仅用于查看包信息，不会修改原文件
- 大型应用包解析可能需要几秒钟

---

### 3.4 应用重签名

对 HAP / APP / HSP 应用包进行重签名，使其可以安装到已注册的调试设备上。

**功能特性**：
- 支持拖拽或点击选择应用包文件
- 自动解析包名、版本号、应用名称、图标等信息
- 可视化进度条和详细日志，失败时展示具体错误原因
- 成功后可一键打开输出目录

**使用步骤**：
1. 在左侧导航栏点击「应用重签名」
2. 将 HAP/APP/HSP 文件拖入上传区域，或点击选择文件
3. 确认解析出的包信息（包名、版本等）正确
4. 点击「开始重签名」按钮
5. 在日志区域查看重签进度，等待完成
6. 成功后点击「输出目录」按钮，查看重签后的应用包

**前置条件**：
- 需要先登录华为开发者账号
- 账号下需要有有效的调试证书和 Profile 文件
- 目标安装设备的 UDID 需要已注册到该账号

**注意事项**：
- 重签名会替换原包的签名信息，仅用于调试目的
- 发布应用请使用正式的发布证书签名
- 如果重签失败，请检查证书是否过期、设备是否已注册

---

### 3.5 设备管理与注册

查看已连接的设备信息，并将设备注册到华为开发者账号。

**功能特性**：
- 展示设备详细信息：名称、型号、UDID、ABI 架构、系统版本等
- 自动识别设备是否已注册，避免重复占用名额
- 支持批量选择未注册设备进行快速注册

**使用步骤**：
1. 在「重签名」页面切换到「已注册设备」标签页
2. 查看当前账号下已注册的设备列表
3. 点击「快速注册」按钮，选择需要注册的本地设备
4. 确认后提交注册

**注意事项**：
- 华为开发者账号的调试设备注册数量有上限（通常为 10 台）
- 注册后的设备 UDID 会与账号绑定，用于调试签名验证
- 如需注销设备，请前往华为开发者联盟官网操作

---

### 3.6 证书管理

查看和管理华为开发者账号下的调试/发布证书。

**功能特性**：
- 展示证书列表：名称、类型（调试/发布）、有效期
- 帮助确认重签名时使用的证书

**使用步骤**：
1. 在「重签名」页面切换到「证书管理」标签页
2. 查看当前账号下的证书列表
3. 确认目标证书的类型和有效期

**注意事项**：
- 证书的创建和续期请在华为开发者联盟官网操作
- 调试证书有效期通常为 1 年，过期后需要重新申请

---

## 四、使用限制与常见问题

### 4.1 使用限制

| 限制项 | 说明 |
|-------|------|
| 操作系统 | 目前主要在 Windows 上测试，macOS / Linux 可能存在兼容性问题 |
| 设备类型 | 仅支持 Harmony Next 系统设备（手机、平板等） |
| 网络要求 | 设备注册、证书管理等功能需要联网 |
| 账号要求 | 重签名相关功能需要华为开发者账号 |

### 4.2 常见问题

**Q: 设备列表中看不到我的设备？**
- 检查 USB 线是否正常连接，尝试更换 USB 口或数据线
- 确认设备已开启「开发者选项」和「USB 调试」
- 在终端执行 `hdc list targets` 确认 HDC 能识别到设备
- 如果使用网络连接，确认已执行 `hdc tconn <IP>:<端口>`

**Q: 投屏画面黑屏或卡顿？**
- 尝试切换投屏模式（JPEG / H.264）
- 检查 USB 连接是否稳定，或网络是否畅通
- 重启 HO-Kit 和设备后重试

**Q: 重签名失败？**
- 确认已登录华为开发者账号
- 检查证书是否过期
- 确认目标设备的 UDID 已注册到当前账号
- 查看日志区域的详细错误信息

**Q: 性能数据采集不到？**
- 确认设备已正常连接
- 部分指标需要特定系统版本支持
- 尝试重新选择设备和应用

---
