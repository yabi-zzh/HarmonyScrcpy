# HarmonyScrcpy



面向 HarmonyOS 的设备投屏与应用重签名工具，基于 Qt Quick 开发的桌面应用。

**设计理念**：让用户快速上手 - 连接设备即可投屏，选择应用包即可一键重签名。

## 功能特性

### 设备投屏

- **设备发现**：自动扫描并显示本机已连接的 HarmonyOS 设备（USB/无线调试）
- **一键投屏**：支持多设备多窗口同时投屏，实时画面传输
- **投屏配置**：
  - **投屏方式**：`Capture` 模式（推荐）/ `H.264` 硬件编码
  - **帧率调节**：30/60/90/120 fps 可选
    > ⚠️ **当前版本**：推荐使用 **30 fps**，高帧率支持将在后续版本优化
  - **码率设置**：10-60 MB 范围调节
  - **屏幕选择**：支持多屏幕设备的屏幕 ID 配置
    > 🚧 **开发中**：此功能正在开发完善，敬请期待
- **交互控制**：
  - 鼠标点击直接模拟设备触摸操作
  - 右键菜单提供丰富的设备控制功能：
    - 窗口置顶/取消置顶
    - 设备亮屏/熄屏控制
    - 屏幕常亮开关
    - 显示最近任务
    - 屏幕旋转切换

### 应用重签名

- **格式支持**：完美兼容 `.hap` / `.app` / `.hsp` 应用包格式
- **智能解析**：自动解析应用包信息，展示应用详情
- **证书管理**：
  - 华为开发者账号 OAuth 登录
  - 申请默认开发证书
  - 删除过期或无用证书
- **设备管理**：
  - 查看已注册设备列表
  - 手动注册新设备
  - 快速注册当前连接的设备
- **签名流程**：一键启动，实时进度显示，完成后可直接查看输出结果

## 系统要求

### 支持的设备
- **HarmonyOS Next** 真机 和 Emulator（版本 ≥ 4.1.4.0）
- **OpenHarmony** 真机（版本 ≥ 4.1.4.0）

### 版本检测
- 应用会自动检测设备的 uitest 版本来判断是否支持投屏
- 检测命令：`hdc shell uitest --version`
- 最低要求版本：4.1.4.0
- 默认支持投屏，检测到不兼容版本时禁用投屏功能
- 不支持的设备将显示"版本不支持"，点击时弹出详细提示


## 快速开始

1. **下载安装**：下载并解压后，双击运行 `OHScrcpy.exe`（Windows x64）
2. **设备准备**：确保 HarmonyOS Next 或 OpenHarmony 设备已开启开发者模式和调试功能
3. **连接设备**：通过 USB 数据线或无线调试连接设备到电脑
4. **版本检测**：应用将自动检测设备版本兼容性
5. **开始使用**：选择投屏或重签名功能即可开始使用

## 使用指南

### 设备投屏操作

**第一步：准备设备**
- 在 HarmonyOS 设备上开启**开发者模式**和 **USB 调试**
- 使用 USB 数据线连接设备到电脑，首次连接需在设备端确认调试授权

**第二步：扫描设备**
- 在应用**「设备管理」**页点击**「刷新设备」**
- 确认设备正确显示在设备列表中
- 应用会自动检测设备的 uitest 版本兼容性

**第三步：配置投屏参数**（可选）
- 点击**「投屏设置」**调整投屏方式、帧率、码率等参数
- 建议使用默认推荐设置以获得最佳体验
- 点击**「保存」**确认设置

**第四步：开始投屏**
- 点击**「开始投屏」**按钮（如果设备版本不支持，按钮将显示为不可点击状态）
- 系统将自动打开投屏窗口并开始画面传输

**第五步：设备控制**
- 鼠标点击投屏窗口可直接模拟设备触摸操作
- 右键点击投屏窗口打开控制菜单，包含：
  - 窗口置顶/取消置顶
  - 设备亮屏/熄屏控制
  - 屏幕常亮开关
  - 显示最近任务
  - 屏幕旋转切换

**第六步：结束投屏**
- 关闭投屏窗口或点击**「停止投屏」**按钮即可结束


### 应用重签名操作

**第一步：登录开发者账号**
- 切换至**「应用重签名」**页面
- 点击**「登录」**按钮，使用华为开发者账号完成 OAuth 认证
- 确保账号具备证书管理和设备注册权限

**第二步：管理开发证书**
- 在**「证书管理」**标签页中查看现有证书
- 如需要，可以申请默认开发证书
- 删除过期或不需要的证书

**第三步：注册测试设备**
- 切换到**「设备」**标签页
- 选择以下方式之一注册设备：
  - 查看已注册设备列表
  - 手动注册新设备（输入设备信息）
  - 快速注册当前连接的设备

**第四步：选择应用包**
- 在**「重签名」**标签页中，拖拽或点击选择应用包文件
- 支持 `.hap`、`.app`、`.hsp` 格式
- 等待系统自动解析应用包

**第五步：确认应用信息**
- 查看解析出的应用信息，包括：
  - 应用名称和版本
  - 包名和权限信息
  - 依赖关系和设备类型

**第六步：开始重签名**
- 点击**「开始签名」**按钮
- 系统显示实时进度和状态信息
- 等待重签名流程完成

**第七步：获取结果**
- 签名完成后，点击**「打开输出目录」**
- 在输出目录中查看重签名后的应用包文件

---

**反馈与支持**

如有问题或建议，欢迎提 Issues

